#include <stdio.h>
#include <openssl/bn.h>	


void printBN(char*msg, BIGNUM*a)
{
	char*number_str = BN_bn2hex(a);
	printf("%s %s\n", msg, number_str);
	OPENSSL_free(number_str);}


void main()
{	
	
	BN_CTX *ctx = BN_CTX_new();
	BIGNUM *n = BN_new();
	BIGNUM *e = BN_new();
	BIGNUM *S = BN_new();
	BIGNUM *D_S = BN_new();
	BIGNUM *M_S = BN_new();
	

	// Assign n
	BN_hex2bn(&n, "8B5E0156B9EC6B11EF48E9439E9BC8BA5391A5BDAB2AFA5E3A35E10D5C35EA52A89934280F7E592B486BE7B4D74B7D2F83CFFE8B26C359791F60A169A75ACB9F3721EF18BD9BFD41EB757CB796D95E86CB2A12E2A7F703E4CEE605F7419B1EBCD2F6D16669510CDEB5ED3C0B27CF888E203DE34E958F1534C626CBF73F64E9F530257DCDA9399B3FEA7A692B8BC47D0BF85693B66B96CAECCFD27BBD43BED3F589DA4D744921C4BDF530BCBC49A96515B3D6FFBF1D90949C0825B6ADCFFCC7D9FB55D519D04ABF6246E524ED8FBE64980C6A519E7A807320A9B4D9BF436A9E10AD2BA0CD64AD4039D2E2B8DBC2F23AA3E2B716971F1EF6CFDF3C1E58E900076B");	// Assign e
	BN_hex2bn(&e, "10001");

	//Assign signature
	BN_hex2bn(&S, "0a568b23274dc9b6eb01248410c25150f11feadc9a7b2ad870e95dc3c2dfdca70c99482cc9b04f56c60654656283accb7c2d99062e25e5408e6c868b8d3e86eb7f34c7b70225b5a31a9308d531cdd4121dd22b7298e50098cd8c7571e900856ea23491ebf7ffb784193d66438be2fea23291a0c19de0ddf06169abcd564b27f1f03cf343b8d2a36de178d3e98ad33f34c88afb45feda162173c9772bf4409f11c5496822f36dfcb5c845cb4244e3a3f03dfeef7999b2574e2e257cfd9065c5233c28ac72640f17b6d908be2e347b123668476fdba449ba9f62b41694f31c2b2a9ad11e0ebfdb914dd0fc2b13814140136bafbb0dcbf6b1d25e45f4315b28b8a1");
	//Decrypt signature
	BN_mod_exp(D_S, S, e, n, ctx);

	//Assign manually calculated signature
	BN_hex2bn(&M_S,"64f27566b7ae22987803bdd26ceda493b08576f1e4fc274071327fc157e8bcd7");

	printBN("e is: ", e);
	printBN("n is: ", n);	
	printf("-------------------------------------\n");	
	//printBN("Original signature is: ",S);
	printBN("The decrypted signature is: ",D_S);
	printBN("\nManually calculated signature is: ",M_S); 
	

}
